# 0.0.0 Scaffolding Specification

## Project Overview

Dibble is a restaurant review application built with Dioxus 0.7 (fullstack Rust framework). The project is currently in its initial scaffolding phase with basic routing, components, and a fullstack setup.

**Repository:** github.com/mister-chicken/dibble

**Current Version:** 0.0.0 (scaffolding)

**Vision:** A beautiful, open-source restaurant review app that helps you remember, reflect on, and share where you eat — starting with effortless map-based logging and photo association.

## Technology Stack

### Core Framework

- **Dioxus:** 0.7.0 with fullstack features
- **Rust:** Edition 2021
- **Platform Support:** Web, Desktop, Mobile (via feature flags)

### Dependencies

- `dioxus = { version = "0.7.0", features = ["router", "fullstack"] }`
- Features: `web`, `desktop`, `mobile`, `server` (all optional via feature flags)

### Testing Infrastructure

- **E2E Testing:** Python 3.12+ with Playwright
- **Test Framework:** pytest
- **Code Quality:** ruff (Python), rustfmt (Rust)
- **Pre-commit Hooks:** Automated formatting and linting

## Project Structure

```
dibble/
├── assets/                    # Static assets
│   ├── favicon.ico
│   ├── header.svg
│   ├── tailwind.css          # Auto-generated Tailwind CSS
│   └── styling/              # Component-specific CSS
│       ├── blog.css
│       ├── echo.css
│       ├── main.css
│       └── navbar.css
├── src/
│   ├── main.rs               # Entry point, route definitions
│   ├── components/           # Shared UI components
│   │   ├── mod.rs
│   │   ├── hero.rs           # Hero section component
│   │   └── echo.rs           # Fullstack echo demo component
│   └── views/                # Route components
│       ├── mod.rs
│       ├── home.rs           # Home page (/)
│       ├── blog.rs           # Blog page (/blog/:id)
│       └── navbar.rs         # Layout navbar component
├── tests/                    # E2E test suite
│   ├── __init__.py
│   ├── conftest.py           # Playwright fixtures
│   ├── test_dioxus_app.py    # Core app validation tests
│   └── test_example.py       # Example tests
├── Cargo.toml                # Rust dependencies
├── Dioxus.toml               # Dioxus configuration
├── pyproject.toml            # Python dependencies & ruff config
├── rustfmt.toml              # Rust formatting config
└── docs/
    ├── roadmap.md            # Future feature roadmap
    └── spec/
        └── 0.0.0_scaffolding.md  # This document
```

## Current Implementation

### Routing System

The app uses Dioxus Router with a `Route` enum defined in `src/main.rs`:

- **Home Route:** `/` → `Home` component
- **Blog Route:** `/blog/:id` → `Blog` component (dynamic `id: i32` parameter)
- **Layout:** All routes wrapped in `Navbar` layout component

### Components

#### Layout Component

- **Navbar** (`src/views/navbar.rs`):
  - Provides navigation links (Home, Blog)
  - Uses `Outlet<Route>` to render child routes
  - Includes navbar-specific CSS

#### Route Components

- **Home** (`src/views/home.rs`):
  - Renders `Hero` and `Echo` components
  - Accessible at `/`

- **Blog** (`src/views/blog.rs`):
  - Displays blog post with dynamic ID
  - Includes Previous/Next navigation links
  - Uses route parameter `id: i32`
  - Includes blog-specific CSS

#### Shared Components

- **Hero** (`src/components/hero.rs`):
  - Displays header SVG image
  - Shows links to Dioxus resources
  - Static content component

- **Echo** (`src/components/echo.rs`):
  - Demonstrates fullstack server functions
  - Input field that echoes text via server function
  - Uses `use_signal` for reactive state
  - Server function: `#[post("/api/echo")]` → `echo_server(input: String)`

### Styling

- **Tailwind CSS:** Auto-generated from `tailwind.css` (Dioxus 0.7+ automatic Tailwind)
- **Component CSS:** Separate CSS files for each major component
- **Asset System:** Uses `asset!()` macro for asset paths

### Server Functions

Currently implements one server function:

- `echo_server`: POST endpoint at `/api/echo` that echoes input string back

## Testing

### E2E Test Coverage

All tests in `tests/test_dioxus_app.py` validate:

1. **Home Page Loading:** Verifies page loads and displays content
2. **Navbar Navigation:** Tests navigation links work correctly
3. **App Hydration:** Ensures Dioxus app is fully hydrated and interactive
4. **Blog Route:** Validates dynamic route parameter handling
5. **Routing System:** End-to-end routing functionality

### Test Execution

**Prerequisites:**

- Dioxus server running: `dx serve --platform web`
- Python dependencies: `uv sync --extra dev`
- Playwright browsers: `uv run playwright install`

**Run Tests:**

```bash
uv run pytest tests/
```

### Test Configuration

- **Base URL:** `http://localhost:8080` (configurable via `BASE_URL` env var)
- **Browser:** Playwright (headless by default)
- **Viewport:** 1280x720
- **Fixtures:** Shared in `tests/conftest.py`

## Development Workflow

### Running the Application

```bash
# Default platform (mobile)
dx serve

# Specific platform
dx serve --platform web
dx serve --platform desktop
```

### Code Quality

**Pre-commit Hooks:**

- Python: ruff formatting and linting
- Rust: rustfmt formatting
- Install: `uv sync --extra dev && uv run pre-commit install`

**Manual Checks:**

```bash
# Python
uv run ruff format .
uv run ruff check .

# Rust
cargo fmt --all

# All checks
uv run pre-commit run --all-files
```

## Configuration Files

### Cargo.toml

- Package name: `dibble`
- Version: `0.1.0`
- Dioxus with router and fullstack features
- Feature flags for web/desktop/mobile/server

### Dioxus.toml

- App title: "dibble"
- Web platform configuration
- Asset and resource settings

### pyproject.toml

- Python 3.12+ requirement
- Dev dependencies: playwright, pytest, ruff, pre-commit
- Ruff configuration for formatting and linting

## Current Limitations / Not Implemented

Based on `docs/roadmap.md`, the following are **NOT** yet implemented:

### Missing Core Features (v0.1 MVP)

- Map view with restaurant pins
- Restaurant data model and persistence
- Photo association with location
- Review feedback system
- REST API endpoints (beyond echo demo)
- Authentication (even placeholder)

### Missing Infrastructure

- Database (SQLite/Postgres)
- Dockerfile for deployment
- CI workflow (GitHub Actions)
- Project documentation beyond README

## Key Dioxus 0.7 Patterns Used

1. **Components:** `#[component]` macro, return `Element`
2. **State:** `use_signal()` for local reactive state
3. **Routing:** `#[derive(Routable)]` enum with `#[route()]` attributes
4. **Layouts:** `#[layout()]` attribute with `Outlet<Route>`
5. **Server Functions:** `#[post()]` / `#[get()]` macros
6. **Assets:** `asset!()` macro for static assets
7. **RSX:** `rsx!` macro for UI definition

## Next Steps (From Roadmap)

The next phase (v1.0 MVP) should implement:

1. Map view with OpenStreetMap/Mapbox
2. Restaurant data model with persistence
3. Photo association with location
4. Review feedback system
5. Backend REST API

---

**Document Purpose:** This specification serves as input for Cursor plan mode to implement properly spec'd and tested features. Each future version should have its own `{VERSION}_name.md` specification document.
